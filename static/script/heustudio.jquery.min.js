/*! heustudio.jquery.min.js 1.0 | (c) 2014 */
$(document).ready(function(){
	if($("#suc").length>0){
    	$("#suc").fadeOut(2000);
		$("#suc").fadeOut("slow");
  //   	$("#suc").fadeOut();
	}
	$("#authcode").blur(function(){

		$.ajax({
			url:'/t/authcode/?imgcode='+$("#authcode").val(),
			type:'get',
			dateType:'json',
			success:function(data){
				$("#imgcode").text(data.msg);
				if (data.msg=="sucess")
				{
					$("#imgcode").hide();
					$(".tipcode").hide();
					$(".suctipcode").show();
				}
				else
				{
					$("#imgcode").show();
					$(".tipcode").show();
					$(".suctipcode").hide();
				}	
			}

		});
	});

	
	$("#username").blur(function(){

		$.ajax({
			url:'/t/user_name/?usname='+$("#username").val(),
			type:'get',
			dateType:'json',
			success:function(data){
				$("#uniname").text(data.msg);
				
				if (data.msg=="sucess")
				{
					$("#username").attr("data",$("#username").val());
					$("#uniname").hide();
					$(".tipusername").hide();
					$(".suctipusername").show();
				}
				else
				{
					$("#uniname").show();
					$(".tipusername").show();
					$(".suctipusername").hide();
				}
			}

		});
	});

//	$("#userid").blur(function(){

//		$.ajax({
//			url:'/t/test/?userid='+$("#userid").val(),
//			type:'get',
//			dateType:'json',
//			success:function(data){
//				$("#uidmsg").text(data.msg);
//				if (data.msg=="sucess")
//					$("#uidmsg").hide();
//				else
//					$("#uidmsg").show();
//			}
//
//		});
//	})
	
	var count = 0;//记录点击次数

	function resetHeight(){
		$(".rightbar ").css("height",$(".content ").css("height"));
		$(".sidebar ").css("height",$(".content ").css("height"));
		$(".bar ").css("min-height",$(".dinfo ").css("height"));
	}
	resetHeight();
	//防震设置
	$("#ld").click(function(){
		if($('input:radio[name="level"]:checked').val() == 2){
			$("#lds").removeClass("disabled").attr("disabled",false);
		}
		else{
			$("#lds").addClass("disabled").attr("disabled",true);
		}
	});
	
	$(".addline").mouseover(function(){ 
		$(this).next(".linetip").show();
	});
	$(".addline").mouseout(function(){ 
		$(this).next(".linetip").hide();
	});
	
	//添加一行备注
	$(".addline").click(function(){ 
		count++;
		var idname = "index" + new Date().getTime();
		var data = $(this).parent(".item").attr("data");
		var parendata = $(this).parents(".dlisf").attr("data");
		var biaoshi = data+parendata+count;
		var htmlt = "<div id=\""+biaoshi+"\" class=\"bsh\"></div>"
		$(this).parents("#dlisf"+parendata).append(htmlt);
		$("#"+biaoshi).append($("#clone .item").clone(true));//克隆
		//radiobutton
		$("#"+biaoshi+" .item" ).attr("id",biaoshi);
		$("#"+biaoshi+" .item #quantity .cinfoi").attr("name","m"+data+"nn"+count);
		$("#"+biaoshi+" .item #degree .cinfoi").attr("name","m"+data+"nl"+count);
		$("#"+biaoshi+" .item .oplus").attr("data","m"+data+count);
		$("#"+biaoshi+" .item .ominus").attr("data","m"+data+count);
		$("#"+biaoshi+" .item .ts").attr("id","ts"+"m"+data+count);
		
		var paid = $(this).parents(".item").attr("id");
		$("#dinfotip #d"+paid).append("<p class=\"i zzli\" id='i"+biaoshi+"'>『<span class=\"nl\"></span>』 - 『备注：<span class=\"bz\"></span>』 - 『<span class=\"ns\">0</span>』</p>");
	});
	
	$(".minline").mouseover(function(){ 
		$(this).next(".linetip").show();
	});
	$(".minline").mouseout(function(){ 
		$(this).next(".linetip").hide();
	});
	
	$(".minline").click(function(){
		$(this).parents(".item").remove();
		// var data = $(this).parent(".item").attr("data");
		// $("#iii #"+data+"i p").last().remove();
		var mpaid = $(this).parents().attr("id");
		$("#dinfotip #i"+mpaid).remove();
	});
	
	$(".cinfoi").on("change",function() {
		var o = $(this).parents(".dlisf").prev(".title");
		var addspan = $("#"+o.text());
		if(addspan.children().children().length==0)
		{
			addspan.children().append("<span>√</span>");
		}
		addspan.addClass("hover");
		addspan.prevAll().removeClass("hover");
		addspan.nextAll().removeClass("hover");
		var ids = $(this).parent("fieldset").parent("div").attr("id");
		var pids = $(this).parents(".dlisf").prevAll(".title").attr("id");
		if(ids != null){
			var slo = $("#"+ids).children("fieldset").children("input[name='"+ids+"nn']:checked");
			var sl = (slo.size() == 0)?"":slo.val();
			switch(sl){
				case "0":
					var hsl = "个别";
					break;
				case "1":
					var hsl = "少数";
					break;
				case "2":
					var hsl = "多数";
					break;
				case "":
					var hsl = "";
					break;
			}
			var cdo = $("#"+ids).children("fieldset").children("input[name='"+ids+"nl']:checked");
			if((cdo.size() == 0)&&(ids != null)){
				$("#"+ids).children("fieldset").children("input[id='qw']").attr("checked","checked");
				var hcd = "轻微";
			}
			else{
				var cd = cdo.val();
				switch(cd){
				case "0":
					var hcd = "轻微";
					break;
				case "1":
					var hcd = "中等";
					break;
				case "2":
					var hcd = "严重";
					break;
				case "":
					var hsl = "";
					break;
			}
			}
			var s = $(this).parents().prevAll(".title").html();
			var ss = $(this).parents().prevAll(".htitle").children(".left").html();
			$("#dinfotip #"+pids+" h3").html("【 "+s+" 】");
			$("#dinfotip #"+pids+" h3").show();
			$("#dinfotip #"+pids+" #p"+ids).html("--"+ss);
			$("#dinfotip #"+pids+" #p"+ids).show();
			$("#dinfotip #"+pids+" #d"+ids+" #parent .nl").html(hsl+hcd);
			$("#dinfotip #"+pids+" #d"+ids).show();
		}
		else 
			{return;}
		// var mid = $(this).parents(".oitem").nextAll().children(".item").attr("id");
		// $("#dinfotip #"+pids+" #d"+ids+" #"+mid).html(hsl+hcd);
		//$("#iii ."+ids+"i .nl").html(sl + cd);
		//$("." + $(this).parent("fieldset").parent("div").attr("data") + "s").show() ;
	});
	
	$("#degree .cinfoi").on("change",function(){
		var pids = $(this).parents(".dlisf").prevAll(".title").attr("id");
		var cop = $(this).parents(".item").parent().attr("id");
		var dcopval = $(this).val();
		switch(dcopval){
			case "0":
				var mdcop = "轻微";
				break;
			case "1":
				var mdcop = "中等";
				break;
			case "2":
				var mdcop = "严重";
				break;
			case "":
				var mdcop = "";
				break;
		}
		var nr = $("#dinfotip #"+pids+" #i"+cop+" .nl").html();
		var snr = nr.substring(0,2);
		$("#dinfotip #"+pids+" #i"+cop+" .nl").html(snr+mdcop);

	});

	$("#quantity .cinfoi").on("change",function(){
		var pids = $(this).parents(".dlisf").prevAll(".title").attr("id");
		var cop = $(this).parents(".item").parent().attr("id");
		var copval = $(this).val();
		switch(copval){
			case "0":
				var mcop = "个别";
				break;
			case "1":
				var mcop = "少数";
				break;
			case "2":
				var mcop = "多数";
				break;
			case "":
				var mcop = "";
				break; 
				}
		var nr = $("#dinfotip #"+pids+" #i"+cop+" .nl").html();
		var snr = nr.substring(0,2);
		$("#dinfotip #"+pids+" #i"+cop+" .nl").html(mcop+snr);
	});

	$(".dlisf div .tb").on("keyup",function(){

		if($(this).val() != ""){
			

			$(this).next("div").children(".ts").attr("disabled",false);
			$(this).next("div").children(".pl5min").removeAttr("disabled");			
		}else{
			$(this).next("div").children(".ts").val(0).attr("disabled",true);
			//$("#" + $(this).parent("div").parent("div").attr("data") + "i ." + $(this).parent("div").parent("div").attr("id") + "i .ns").html("0");
			$(this).next("div").children(".pl5min").attr("disabled","disabled");
		}
	});
	
	$(".dlisf div .tb").on("blur",function(){
		var v = $(this).val();
		//var ids = $(this).parent("div").parent("div").attr("id");
		var ids = $(this).parents(".item").attr("id");
		var pids = $(this).parents(".dlisf").prevAll(".title").attr("id");
		$("#dinfotip #"+pids+" #d"+ids+" #parent .bz").html(v);
		$("#dinfotip #"+pids+" #d"+ids).show();

		var cop = $(this).parents(".item").parent().attr("id");
		$("#dinfotip #"+pids+" #i"+cop+" .bz").html(v);
		// $("#iii ."+ids+"i .bz").html(v);
		// $("." + $(this).parent("div").parent("div").attr("data") + "s").show() ;
	});
	
	$(".dlisf div .ts").on("blur",function(){
		var v = $(this).val();
		var ids = $(this).parents(".item").attr("id");
		var pids = $(this).parents(".dlisf").prevAll(".title").attr("id");
		$("#dinfotip #"+pids+" #d"+ids+" #parent .ns").html(v);
		$("#dinfotip #"+pids+" #d"+ids).show();

		var cop = $(this).parents(".item").parent().attr("id");
		$("#dinfotip #"+pids+" #i"+cop+" .ns").html(v);
	});
	
	$("#online").mouseover(function(){
		$(".qq").show();
		$(".oimg").css("border-color","#fff");
	});
	$("#online").mouseout(function(){
		$(".qq").hide();
		$(".oimg").css("border-color","#ddd");
	});
	
	$("#image").mouseover(function(){
		$(".image").show();
		$(".oimg").css("border-color","#fff");
	});
	$("#image").mouseout(function(){
		if($(this).children("div").children(".fixedbar").children(".tdico").attr("data") == "hide"){
			$(".image").hide();
			$(".oimg").css("border-color","#ddd");
			$(this).children(".oimg").removeClass("hover");
			$(this).parent(".rightbar").removeClass("hopacity");
		}
		else{
			$(this).children(".oimg").addClass("hover");
			$(this).parent(".rightbar").addClass("hopacity");
		}
	});
	
	$(".fixedbar .tdico").click(function(){
		if($(this).attr("data") == "hide"){
			$(this).attr("data","show");
			$(this).css("background-position","center left");
		}
		else{
			$(this).attr("data","hide");
			$(this).css("background-position","center right");
		}
		
	});
	
	$("#video").mouseover(function(){
		$(".video").show();
		$(".oimg").css("border-color","#fff");
	});
	$("#video").mouseout(function(){
		if($(this).children("div").children(".fixedbar").children(".tdico").attr("data") == "hide"){
			$(".video").hide();
			$(".oimg").css("border-color","#ddd");
			$(this).children(".oimg").removeClass("hover");
			$(this).parent(".rightbar").removeClass("hopacity");
		}
		else{
			$(this).children(".oimg").addClass("hover");
			$(this).parent(".rightbar").addClass("hopacity");
		}
	});
	
	
	$(".changeitem li").click(function(){
		$(".changeitem li").removeClass("hover");
		$(this).addClass("hover");
		
		$(this).parent("ul").next("div").children(".tt").html($(this).text());
		$(this).parent("ul").next("div").children("img").attr("src",$(this).attr("data"));
		$(this).parent("ul").next("div").children(".tde").html($(this).attr("desc"));
	});
	/*
	$("#online").css("top",($(window).height()/2)+$(document).scrollTop()-40);
	$(document).scroll(function(){
		$("#online").css("top",(($(window).height() - 95)/2)+$(document).scrollTop()-40);
	})*/
	
	$("#totop").click(function(){
		$(document).scrollTop(0);
	});
	
	function hidehelp(){
		$(".tipinfo").hide();
	}
	var helptip;
	$(".helptip").mouseover(function(){
		 $(".tipinfo").show();  
	});
	
	$(".helptip").mouseout(function(){
		 helptip = setTimeout(hidehelp, 1000); 
	});
	
	$(".htip").mouseover(function(){
		helptip = window.clearTimeout(helptip); 
	});
	
	$(".htip").mouseleave(function(){
		 helptip = setTimeout(hidehelp, 1000);
	});
	
	$("#tipbtn").mouseover(function(){
		$(".btntipinfo").show();
	});
	
	$("#tipbtn").mouseout(function(){
		$(".btntipinfo").hide();
	});
	
	$(".setinput").change(function(){
		$("#" + $(this).attr("data")).val($(this).children('option:selected').val());
	});
	
	$(".plus").on("click",function(){
		if($(this).parent("div").attr("disabled") == "disabled") return;
		var o = $("#ts" + $(this).attr("data"));
		o.focus();
		var reg =  /^\d+$/;
		var num = o.val();
		(reg.test(num) && num >= 0) ? o.val(num * 1 + 1) : o.val(0);
		o.blur();
	});
	
	$(".minus").on("click",function(){
		if($(this).parent("div").attr("disabled") == "disabled") return;
		var o = $("#ts" + $(this).attr("data"));
		o.focus();
		var reg =  /^\d+$/;
		var num = o.val();
		(reg.test(num) && num >= 1) ? o.val(--num) : o.val(0);
		o.blur();
	});
	
	$(".oplus").on("click",function(){
		if($(this).parent("div").attr("disabled") == "disabled") return;
		var o = $("#ts" + $(this).attr("data"));
		o.focus();
		var reg =  /^[-+]?\d+(\.\d{2})?$/;
		var num = o.val();
		if (num!=0.03)
		{
			(reg.test(num) && num >= (-0.03) && num<0.03) ? o.val(changeTwoDecimal(num * 1 + 0.01)) : o.val(0.00);
		}else
		{return;}
		o.blur();
	});
	
	$(".ominus").on("click",function(){
		if($(this).parent("div").attr("disabled") == "disabled") return;
		var o = $("#ts" + $(this).attr("data"));
		o.focus();
		var reg =  /^[-+]?\d+(\.\d{2})?$/;
		var num = o.val();
		if(num!=(-0.03))
			{
				(reg.test(num) && num > (-0.03) && num<=0.03) ? o.val(changeTwoDecimal(num * 1 - 0.01)) : o.val(0.00);
			}
		else
		{return;}
		o.blur();
	});
	
	$(".body .func").click(function(){
		$(".body .func").removeClass("hover");
		$(this).addClass("hover");
		
		$(".body .cfunc").hide();
		$("#" + $(this).attr("data")).show();
		// // 在这块改变一个值
		// // alert($(this).attr("data"));
		// var s = $(this).attr("data");
		// $("#note").val(s);
		// // alert($("#note").attr("value"));
	});
	
	$(".wzs").click(function(){
		var pid = $(this).parents().next(".item").attr("id");
		$("input[name='"+pid+"nn'] ").each(function(){
			$(this).attr("checked",false);
		})
		$("input[name='"+pid+"nl'] ").each(function(){
			$(this).attr("checked",false);
		})
		$("#"+pid+" input[class='tb']").each(function(){
			$(this).attr("value","");
		})
		$("#" + pid + " input[class='ts n']").each(function(){
			$(this).attr("value","0");
			$(this).attr("disabled","");
		})
		$(this).parents(".oitem").nextAll().remove();

		$("#dinfotip #d"+$(this).parents(".oitem").children(".item").attr("id")+" #parent .nl").html("");
		$("#dinfotip #d"+$(this).parents(".oitem").children(".item").attr("id")+" #parent .bz").html("");
		$("#dinfotip #d"+$(this).parents(".oitem").children(".item").attr("id")+" #parent .ns").html("0");

		$("#dinfotip #d"+$(this).parents(".oitem").children(".item").attr("id")+" #parent").nextAll().remove();
	});
	
	$(".body > .sidebar > li").click(function(){
		if($(this).children("div").children("a").attr("href") != ""){window.location = $(this).children("div").children("a").attr("href");}
	});	
	
	$(".banner > .header .menu li").click(function(){
		if($(this).children("a").attr("href") != ""){window.location = $(this).children("a").attr("href");}
	});	
	
	$("#infolistbg input[name = 'infolist']").click(function(){
		$("#infolistbg tr").removeClass("tabletrtdcolor");
		$(this).parents("tr").addClass("tabletrtdcolor");
	});
	
	$("#happened input[name='ph']").click(function(){
		var n = $('#happened input:radio[name="ph"]:checked').val() * 1;
		$("#ps input[name='ps']").each(function(){
			var t = $(this).val() * 1;
			if((t >= n) && (t != 0)){
				$(this).attr("disabled","disabled");
				$(this).parent("span").css("color","#ccc");
			}
			else{
				$(this).attr("disabled",false);
				$(this).parent("span").css("color","#333");
			}
		});
		
		$("#pb input[name='pb']").each(function(){
			var t = $(this).val() * 1;
			if((t < n) && (t != 0)){
				$(this).attr("disabled","disabled");
				$(this).parent("span").css("color","#ccc");
			}
			else{
				$(this).attr("disabled",false);
				$(this).parent("span").css("color","#333");
			}
		});
	});
	
	$(".addsearch").click(function(){
		var htmlt = "<div class=\"left search adds\"><select class=\"select relation\" name ='xz'><option value='bq'>并且</option><option value='hz'>或者</option></select><select class='select' name='tj'><option value='a.building_admregioncode'>行政区编码</option> <option value='e.eq_earthquakename'>地震名称</option><option value='a.building_buildnumber'>建筑物编号</option><option value='b.result_securitycategory'>安全类别</option><option value='b.result_totaldamageindex'>震损指数</option><option value='a.building_buildname'>建筑物名称</option><option value='a.building_househostname'>房主</option><option value='a.building_buildyear'>建成年份</option><option value='a.building_fortificationinfo'>抗震设防状况</option><option value='a.building_fortificationdegree'>抗震设防烈度</option><option value='e.eq_epicentralintensity'>既发地震烈度</option><option value='b.result_assetdate'>鉴定日期</option><option value='a.building_longitude'>中心经度</option> <option value='a.building_latitude'>中心纬度</option><option value='a.building_buildarea'>建筑面积</option><option value='a.building_uplayernum'>主体层数</option><option value='d.building_usagename'>用途</option> <option value='c.user_realname'>鉴定人</option><option value='c.user_title'>鉴定人员职称</option><option value='c.user_workunit'>鉴定单位</option><option value='f.construct_typename'>结构类型</option><option value='b.result_damagedegree'>破坏等级</option></select><input type=\"text\" name='tjtxt' class=\"text\" /><select class=\"select\" name = 'cxms'><option value='jq'>精确</option><option value='mh'>模糊</option></select><input type=\"submit\" class=\"btn\"  onclick='countsearch()' value=\"查询\" /></div>";
		if($(this).parents(".titlebar").children(".adds").size()< 5){
			$(this).parents(".titlebar").children(".search").each(function(){
				$(this).children("input[class='btn']").remove();
			});
			$(this).parents(".titlebar").children(".search").last().after(htmlt);
		}
	});
	
	$(".minsearch").click(function(){
		$(this).parents(".titlebar").children(".adds").last().prev(".search").append("<input type=\"submit\" class=\"btn\"  onclick='countsearch()' value=\"查询\" /></div>");
		$(this).parents(".titlebar").children(".adds").last().remove();
	});

// 地图查询
$(".addsearchMap").click(function(){
		var htmlt = "<div class=\"left search adds\"><select class=\"select relation\" name ='xz'><option value='bq'>并且</option><option value='hz'>或者</option></select><select class='select' name='tj'><option value='a.building_admregioncode'>行政区编码</option> <option value='e.eq_earthquakename'>地震名称</option><option value='a.building_buildnumber'>建筑物编号</option><option value='b.result_securitycategory'>安全类别</option><option value='b.result_totaldamageindex'>震损指数</option><option value='a.building_buildname'>建筑物名称</option><option value='a.building_househostname'>房主</option><option value='a.building_buildyear'>建成年份</option><option value='a.building_fortificationinfo'>抗震设防状况</option><option value='a.building_fortificationdegree'>抗震设防烈度</option><option value='e.eq_epicentralintensity'>既发地震烈度</option><option value='b.result_assetdate'>鉴定日期</option><option value='a.building_longitude'>中心经度</option> <option value='a.building_latitude'>中心纬度</option><option value='a.building_buildarea'>建筑面积</option><option value='a.building_uplayernum'>主体层数</option><option value='d.building_usagename'>用途</option> <option value='c.user_realname'>鉴定人</option><option value='c.user_title'>鉴定人员职称</option><option value='c.user_workunit'>鉴定单位</option><option value='f.construct_typename'>结构类型</option><option value='b.result_damagedegree'>破坏等级</option></select><input type=\"text\" name='tjtxt' class=\"text\" /><select class=\"select\" name = 'cxms'><option value='jq'>精确</option><option value='mh'>模糊</option></select><input type=\"submit\" class=\"btn\"  onclick='f(1)' value=\"查询\" /></div>";
		if($(this).parents(".titlebar").children(".adds").size()< 5){
			$(this).parents(".titlebar").children(".search").each(function(){
				$(this).children("input[class='btn']").remove();
			});
			$(this).parents(".titlebar").children(".search").last().after(htmlt);
		}
	});
	
	$(".minsearchMap").click(function(){
		$(this).parents(".titlebar").children(".adds").last().prev(".search").append("<input type=\"submit\" onclick='f(1)' class=\"btn\" value=\"查询\" /></div>");
		$(this).parents(".titlebar").children(".adds").last().remove();
	});



	
	$(".changeformatjw").click(function(){
		$(".jwitem").hide();
		$("#"+$(this).attr("data")).show();
	});
	$(".jzwlisttable .bgcbox").click(function(){
		$(".jzwlisttable tr").removeClass("tabletrtdcolor");
		$(".jzwlisttable input:checkbox[class='bgcbox']:checked").each(function(){
			$(this).parent("td").parent("tr").addClass("tabletrtdcolor");
		});
	});
	
	$(".sbtn").mouseover(function(){
		$(this).next(".sbtns").css("z-index","2");
		$(this).prev(".selectskin").css("z-index","-2");
	});
	
	$(".sbtns").mouseleave(function(){
		$(this).css("z-index","-2");
		$(this).prev(".sbtn").prev(".selectskin").css("z-index","2");
	});
	
	$(".sclazinfoimg img").click(function(){
		$("#bpreview img").attr("src",$(this).attr("src"));
		$("#bpreview").css("top",($(window).height()/2)+$(document).scrollTop()-175).css("left",($(window).width()/2)-250).show();
	});
	$("#bpreview .close").click(function(){ $("#bpreview").hide();})
	
	$("#bgcbox").click(function(){
		if($(this).attr("checked") == "checked"){
			$(".bgcbox").attr("checked","checked");
			$(".jzwlisttable tr").addClass("tabletrtdcolor");
		}
		else{
			$(".bgcbox").attr("checked",false);
			$(".jzwlisttable tr").removeClass("tabletrtdcolor");
		}
	});
	
	
	function in_array(searchv,array){
		for(var i in array){
			if(array[i]==searchv){
				return i;
			}
		}
		return -1;
	}
	$(".uinfo .inptxt").blur(function(){
		var o =$(this);
		
		var arr = ["pass", "rpass", "realname", "idnum", "major", "depart","title", "address","zipcode", "phone", "email"];
		var t = o.attr("data");
		var v = o.val();
		
		var tipinfo = "";
		switch(in_array(t,arr)){
			case "-1":
				return;
				break;
			case "0":
			    if(v.length < 6){
					 $("#pword").text("密码不能小于6位");
					 $("#pword").show();
					 $(".tippass").show();
					 $(".suctippass").hide();
				}
				else if(v.length >30){
					$("#pword").text("密码不能大于30位");
					$("#pword").show();
					$(".tippass").show();
					$(".suctippass").hide();
				}
				else{
					$("#pword").text("sucess");
					$("#pword").hide();
					$(".tippass").hide();
					$(".suctippass").show();
				}
				break;
			case "1":
			    if(v==""){
			    	$("#rpword").text("确认密码不能为空！");
					$("#rpword").show();
					$(".tiprpass").show();
					$(".suctiprpass").hide();
			    }else if(v != $("#password").val()){
			    	$("#rpword").text("确认密码和密码不一致");
					$("#rpword").show();
					$(".tiprpass").show();
					$(".suctiprpass").hide();
				}
				else{
					$("#rpword").text("sucess");
					$("#rpword").hide();
					$(".tiprpass").hide();
					$(".suctiprpass").show();
				}
				break;
			case "2":
			    if(v==''){
			  //   	$("#rname").text("真实姓名不能为空");
					// $("#rname").show();
					$("#rname").text("sucess");
					$("#rname").hide();
					$(".tipusername").show();
					$(".suctiprealname").hide();
					break;
			    }
			    if(v.length>30){
			    	$("#rname").text("姓名太长！");
					$("#rname").show();
					$(".tipusername").show();
					$(".suctiprealname").hide();
			    }
			    else{
			    	$("#rname").text("sucess");
					$("#rname").hide();
					$(".suctiprealname").show();
					$(".tipusername").hide();
			    }
			    break;
			case "3":
			    var lentest=/^\d{17}(\d|x)$/;
			    var aCity={'11':"北京",'12':"天津",'13':"河北",'14':"山西",'15':"内蒙古",'21':"辽宁",'22':"吉林",'23':"黑龙江",'31':"上海",'32':"江苏",'33':"浙江",'34':"安徽",'35':"福建",'36':"江西",'37':"山东",'41':"河南",'42':"湖北",'43':"湖南",'44':"广东",'45':"广西",'46':"海南",'50':"重庆",'51':"四川",'52':"贵州",'53':"云南",'54':"西藏",'61':"陕西",'62':"甘肃",'63':"青海",'64':"宁夏",'65':"新疆",'71':"台湾",'81':"香港",'82':"澳门",'91':"国外"};
			    sBirthday=v.substr(6,4)+"-"+Number(v.substr(10,2))+"-"+Number(v.substr(12,2));
			    var d=new Date(sBirthday.replace(/-/g,"/"));
			    if(v==""){
			    	$("#cardnum").text("sucess");
					$("#cardnum").hide();
					$(".tippass").show();
					$(".succardnum").hide();
					break;
			    }
			    if(!lentest.test(v)){
			    	$("#cardnum").text("身份证格式或长度错误！");
					$("#cardnum").show();
					$(".tippass").show();
					$(".succardnum").hide();
			    }
			    else if(aCity[(v.substr(0,2))]==null){
			    	$("#cardnum").text("你的身份证地区非法，请填写正确的身份证信息！");
					$("#cardnum").show();
					$(".tippass").show();
					$(".succardnum").hide();
			    }
			    else if(sBirthday!=(d.getFullYear()+"-"+ (d.getMonth()+1) + "-" + d.getDate())){
			    	$("#cardnum").text("身份证上出生日期错误！");
					$("#cardnum").show();
					$(".tippass").show();
					$(".succardnum").hide();
			    }
			    else{
			    	$("#cardnum").text("sucess");
					$("#cardnum").hide();
					$(".succardnum").show();
					$(".tippass").hide();
			    }
			    break;
			case "4":
			    if(v==""){
			    	$("#majormsg").text("请填写专业！");
			    	$("#majormsg").show();
			    	$(".tipmajor").show();
			    	$(".sucmajor").hide();
			    }
			    else if(v.length>50){
			    	$("#majormsg").text("专业长度太长，请简单填写！");
			    	$("#majormsg").show();
			    	$(".tipmajor").show();
			    	$(".sucmajor").hide();
			    }
			    else{
			    	$("#majormsg").text("sucess");
			    	$("#majormsg").hide();
			    	$(".tipmajor").hide();
			    	$(".sucmajor").show();
			    }
			    break;
			case "5":
			    if(v==""){
			    	$("#departmsg").text("请填写单位！");
					$("#departmsg").show();
					$(".tipdepart").show();
					$(".sucdepart").hide();
			    }
			    else if(v.length>50){
			    	$("#departmsg").text("单位长度太长，请简单填写！");
					$("#departmsg").show();
					$(".tipdepart").show();
					$(".sucdepart").hide();
			    }
			    else{
			    	$("#departmsg").text("sucess");
					$("#departmsg").hide();
					$(".tipdepart").hide();
					$(".sucdepart").show();
			    }
			    break;
			case "6":
			    if(v==""){
			    	$("#titlemsg").text("请填写职称！");
					$("#titlemsg").show();
					$(".tiptitle").show();
					$(".suctitle").hide();
			    }
			    else if(v.length>20){
			    	$("#titlemsg").text("职称长度太长，请简单填写！");
					$("#titlemsg").show();
					$(".tiptitle").show();
					$(".suctitle").hide();
			    }
			    else{
			    	$("#titlemsg").text("sucess");
					$("#titlemsg").hide();
					$(".tiptitle").hide();
					$(".suctitle").show();
			    }
			    break;
			case "7":
			    if(v==""){
			  //   	$("#addressmsg").text("请填写联系地址！");
					// $("#addressmsg").show();
					$("#addressmsg").text("sucess");
					$("#addressmsg").hide();
					$(".tipaddress").show();
					$(".sucaddress").hide();
			    }
			    else if(v.length>50){
			    	$("#addressmsg").text("联系地址长度太长，请简单填写！");
					$("#addressmsg").show();
					$(".tipaddress").show();
					$(".sucaddress").hide();
			    }
			    else{
			    	$("#addressmsg").text("sucess");
					$("#addressmsg").hide();
					$(".tipaddress").hide();
					$(".sucaddress").show();
			    }
			    break;
			case "8":
			    var reg=/^\d{6}$/
			    if(v==""){
			    	$("#zipcodemsg").text("sucess");
					$("#zipcodemsg").hide();
					$(".tipzipcode").show();
					$(".suczipcode").hide();
					break;
			    }
			    if(!reg.test(v)){
			    	$("#zipcodemsg").text("邮政编码是6位数字！");
					$("#zipcodemsg").show();
					$(".tipzipcode").show();
					$(".suczipcode").hide();
			     }
			     else{
			     	$("#zipcodemsg").text("sucess");
					$("#zipcodemsg").hide();
					$(".tipzipcode").hide();
					$(".suczipcode").show();
			     }
			    break;
			case "9":
			    var isMobile=/^(?:13\d|15\d|18\d)\d{5}(\d{3}|\*{3})$/;
			    var isPhone=/^((0\d{2,3})-)?(\d{7,8})(-(\d{3,}))?$/;
			    if(v==""){
			    	$("#phonemsg").text("sucess");
					$("#phonemsg").hide();
					$(".tipphone").show();
					$(".sucphone").hide();
					break;
			    }
			    if(!isMobile.test(v) && !isPhone.test(v)){
			    	$("#phonemsg").text("请正确填写电话号码，例如:13415764179或0321-4816048");
					$("#phonemsg").show();
					$(".tipphone").show();
					$(".sucphone").hide();
			    } 
			    else{
			    	$("#phonemsg").text("sucess");
					$("#phonemsg").hide();
					$(".tipphone").hide();
					$(".sucphone").show();
			    }
			    break;
			case "10":
			    var reg=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
			    if(!reg.test(v)){
			    	$("#emailmsg").text("请输入正确的邮箱！");
					$("#emailmsg").show();
					$(".tipemail").show();
					$(".sucemail").hide();
			    }
			    else{
			    	$("#emailmsg").text("sucess");
					$("#emailmsg").hide();
					$(".tipemail").hide();
					$(".sucemail").show();
			    }
			    break;
		}
	});
	
	$(".reg_btn").click(function(){
		if($("#username").attr("data") != $("#username").val())
		{

				$.ajax({
				url:'/t/user_name/?usname='+$("#username").val(),
				type:'get',
				dateType:'json',
				success:function(data){
					alert("sdf");
					$("#uniname").text(data.msg);
					if (data.msg  == "sucess")
					{
						if($("#pword").text() !="sucess")
						{
							alert("密码未按规则填写");
							return false;
						}
						if($("#rpword").text()!="sucess")
						{
							alert("确认密码未按规则填写");
							return false;
						}
						if($("#imgcode").text()!="sucess")
						{
							alert("验证码未按规则填写");
							return false;
						}
						if(($("#agreement").attr("checked")!="checked")){
							alert("请选择服务条款");
							return false;
						}
					}else
					{
						alert("用户名未按规则填写");
						return false;
					}
				}
			});
		}

	});

	

	
	$(".compl_btn").click(function(){
		if(($("#rname").text()!="sucess") && ($(".uinfo #realname").val() != "")){
			alert("真实姓名未按规则填写");
			return false;
		}
		else if(($("#cardnum").text()!="sucess") && ($(".uinfo #idnum").val() != "")){
			alert("身份证号未按规则填写");
			return false;
		}
		else if($("#majormsg").text()!="sucess"){
			alert("专业未按规则填写");
			return false;
		}
		else if($("#departmsg").text()!="sucess"){
			alert("单位未按规则填写");
			return false;
		}
		if($("#titlemsg").text()!="sucess"){
			alert("职称未按规则填写");
			return false;
		}
		else if(($("#addressmsg").text()!="sucess") && ($(".uinfo #address").val() != "")){
			alert("联系地址未按规则填写");
			return false;
		}
	    else if(($("#zipcodemsg").text()!="sucess") && ($(".uinfo #zipcode").val() != "")){
			alert("邮政编码未按规则填写");
			return false;
		}
		else if(($("#phonemsg").text()!="sucess") && ($(".uinfo #phone").val() != "")){
			alert("手机号码未按规则填写");
			return false;
		}
		else if($("#emailmsg").text()!="sucess"){
			alert("保密邮箱未按规则填写");
			return false;
		}
		else return;
		if(($("#majormsg").text()=="sucess") && ($("#departmsg").text()=="sucess") && ($("#titlemsg").text()=="sucess") && ($("#emailmsg").text()=="sucess")){
			return true;
		}
		// else{
		// 	alert("请按规则慎重填写信息");
		// 	return false; 
		// }
	});
	
	$(".login_email_btn").click(function(){
		window.open("http://mail.126.com/");
	});
	
	$(".wyx input[type='checkbox']").click(function(){
		if($(this).attr("checked") == "checked" &&( $(this).val() == "CDYXWYX"||$(this).val() == "DJZKWYX"||$(this).val() == "0")){
			$(this).parent("span").parent(".wyx").children("span").children("input[type='checkbox']").attr("checked",false);
			$(this).attr("checked","checked");
			if($(this).val() == "CDYXWYX"){
				$("#CDYXQT").val("");
			}else
				{
					$("#DJZKQT").val("");
				}
		}
		else if($(this).val() != "0"){
			$(this).parent("span").parent(".wyx").children("span").children(".ling").attr("checked",false);
		}
	});
	
	$("#ps input[name='ps']").click(function(){
		$("#pb input[value='0']").attr("checked","checked");
	});
	
	$("#pb input[name='pb']").click(function(){
		$("#ps input[value='0']").attr("checked","checked");
	});
//checkup5点击切换
	$(".localmark").click(function(){
		var o = $(this).prevAll(".h31");
		var right = $(".locationcontentmark");
		for(var i = 0;i<right.length;i++)
		{
			if(right[i].getAttribute('data') == o.text())
			{
				$("#"+right[i].id).css("display","block");
			}
			else
			{
				$("#"+right[i].id).css("display","none");
			}
		}
	});

	//edituser校验
	$(".udetail input[name='userrealname']").blur(function(){
		var v = $(this).val();
		if(v == "")
		{
			$("#uniname").text("用户名不能为空");
			$("#uniname").show();
		}
		else
		{
			$("#uniname").text("sucess");
			$("#uniname").hide();
		}
	});

	$(".udetail input[name='zipcode']").blur(function(){
		var v = $(this).val();
		var re= /^[1-9][0-9]{5}$/;
		if((v.length != 6) || (!re.test(v)))
		{
			$("#jyzipcode").text("邮政编码是6位数字！");
			$("#jyzipcode").show();
		}
		else
		{
			$("#jyzipcode").text("sucess");
			$("#jyzipcode").hide();
		}
	});

	$(".udetail input[name='telnum']").blur(function(){
		var v = $(this).val();
		var isMobile=/^(?:13\d|15\d|18\d)\d{5}(\d{3}|\*{3})$/;
	    var isPhone=/^((0\d{2,3})-)?(\d{7,8})(-(\d{3,}))?$/;
	    if(!isMobile.test(v) && !isPhone.test(v)){
	    	$("#jytelnum").text("请正确填写电话号码，例如:13415764179或0321-4816048");
			$("#jytelnum").show();
	    } 
	    else{
	    	$("#jytelnum").text("sucess");
			$("#jytelnum").hide();
	    }
	});

	$(".udetail input[name='useridcard']").blur(function(){
		var v = $(this).val();
		var lentest=/^\d{17}(\d|x)$/;
	    var aCity={'11':"北京",'12':"天津",'13':"河北",'14':"山西",'15':"内蒙古",'21':"辽宁",'22':"吉林",'23':"黑龙江",'31':"上海",'32':"江苏",'33':"浙江",'34':"安徽",'35':"福建",'36':"江西",'37':"山东",'41':"河南",'42':"湖北",'43':"湖南",'44':"广东",'45':"广西",'46':"海南",'50':"重庆",'51':"四川",'52':"贵州",'53':"云南",'54':"西藏",'61':"陕西",'62':"甘肃",'63':"青海",'64':"宁夏",'65':"新疆",'71':"台湾",'81':"香港",'82':"澳门",'91':"国外"};
	    sBirthday=v.substr(6,4)+"-"+Number(v.substr(10,2))+"-"+Number(v.substr(12,2));
	    var d=new Date(sBirthday.replace(/-/g,"/"));
	    if(!lentest.test(v)){
	    	$("#jyuseridcard").text("身份证格式或长度错误！");
			$("#jyuseridcard").show();
	    }
	    else if(aCity[(v.substr(0,2))]==null){
	    	$("#jyuseridcard").text("你的身份证地区非法，请填写正确的身份证信息！");
			$("#jyuseridcard").show();
	    }
	    else if(sBirthday!=(d.getFullYear()+"-"+ (d.getMonth()+1) + "-" + d.getDate())){
	    	$("#jyuseridcard").text("身份证上出生日期错误！");
			$("#jyuseridcard").show();
	    }
	    else{
	    	$("#jyuseridcard").text("sucess");
			$("#jyuseridcard").hide();
	    }
	});

	$(".udetail input[name='email']").blur(function(){
		var v = $(this).val();
		var reg=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
	    if(!reg.test(v)){
	    	$("#jyemail").text("请输入正确的邮箱！");
			$("#jyemail").show();
	    }
	    else{
	    	$("#jyemail").text("sucess");
			$("#jyemail").hide();
	    }
	});
	$(".btn input[name='imgbtn']").click(function(){
		if(($("#uniname").text()=="sucess") || ($("#jyzipcode").text()=="sucess") || ($("#jytelnum").text()=="sucess") || ($("#jyuseridcard").text()=="sucess") || ($("#jyemail").text()=="sucess")){
			return true;
		}
		
		else{
			alert("请按照提示认真修改信息");
			return false; 
		}
	});
	
	
});

// count查询用
function countsearch()
{
	var d = $("#cxdiv").children();
	var qstring=" and (";
	for(var i = 1;i<d.length-1;i++)
	{
		var c = d[i].childNodes;
		
		for(var j = 0;j<c.length;j++)
		{
			
			if(c[j].name == "xz")
			{
				if(c[j].value == "bq")
				{
					qstring+=" and "
				}else if(c[j].value == "hz")
				{
					qstring+=" or "
				}
			}
			if(c[j].name == "tj")
			{
				qstring+=c[j].value;
			}
			if(c[j].name == "tjtxt")
			{
				if(i==1){
					if($("#cxms").val()=="jq")
						qstring+=" = "+"'"+c[j].value+"' ";
					else
						{
						qstring+=" like '%"+c[j].value+"%'";
						}
				}
				else
				{
					if(c[j+1].value=="jq")
						qstring+=" = "+"'"+c[j].value+"' ";
					else
						{
						qstring+=" like '%"+c[j].value+"%'";
						}
				}
			}
			// if(c[j].name == "cxms")
			// {
			// 	// alert(c[j].value);
			// }
		}
		
	}
	 $.post("/t/countAjax",
        {qstring1:qstring,},
        function(data){
        if(data.length>0)
        {
        	// var data1;
        	// data1 = eval(data);
        	var ind = data.indexOf("pageleng:");
        	var data1 = data.substr(0,ind);
        	var pagenumdata = data.substr(ind+9,data.length);//页数信息
        	var	pageleng = pagenumdata.substr(0,pagenumdata.indexOf("nowpage:"));
        	var pagenow = pagenumdata.substr(pagenumdata.indexOf("nowpage:")+8,pagenumdata.length);
        	data1 = eval(data1);
        	$("#datatable tr:gt(0)").remove();
        	for(var i =0;i<data1.length;i++)
        	{
        		$("#datatable").append("<tr><td><input type=\"checkbox\" class=\"bgcbox\" /></td>");
        		for(var j=0;j<data1[i].length;j++)
        		{
        			$("#datatable tr:last").append("<td>"+data1[i][j]+"</td>");
        		}
        		$("#datatable").append("</tr>");
        	}
        	$("#pagestyle li").remove();
        	if(pageleng>1&&pagenow>1){
        		$("#pagestyle").append("<li> <a  title='上一页' href='javascript:void(0);' onclick='pageclick("+(pagenow-1)+")'><span>&lt;&lt;</span></a></li>");
			}
			for(var q = 1;q<=pageleng;q++)
			{
				if(q==pagenow)
				{
					$("#pagestyle").append("<li>  <a  title='当前页:"+pagenow+"'><span>"+pagenow+"</span></a></li>");
				}
				else
					$("#pagestyle").append("<li>  <a  href='javascript:void(0);' onclick='pageclick("+q+")' title='跳转到第"+q+"页'><span>"+q+"</span></a></li>");
			} 
			if(pagenow<pageleng)
			{
				var pagenex = parseInt(pagenow) + 1;
				$("#pagestyle").append("<li> <a  title='下一页' href='javascript:void(0);' onclick='pageclick("+(pagenex)+")'><span>&gt;&gt;</span></a></li>");
			}

        }

    });
	// location.href = '/t/count?qstring1='+qstring;
}
function pageclick(pagenum)
{
	var d = $("#cxdiv").children();
	var qstring=" and (";
	for(var i = 1;i<d.length-1;i++)
	{
		var c = d[i].childNodes;
		
		for(var j = 0;j<c.length;j++)
		{
			
			if(c[j].name == "xz")
			{
				if(c[j].value == "bq")
				{
					qstring+=" and "
				}else if(c[j].value == "hz")
				{
					qstring+=" or "
				}
			}
			if(c[j].name == "tj")
			{
				qstring+=c[j].value;
			}
			if(c[j].name == "tjtxt")
			{
				if(i==1){
					if($("#cxms").val()=="jq")
						qstring+=" = "+"'"+c[j].value+"' ";
					else
						{
						qstring+=" like '%"+c[j].value+"%'";
						}
				}
				else
				{
					if(c[j+1].value=="jq")
						qstring+=" = "+"'"+c[j].value+"' ";
					else
						{
						qstring+=" like '%"+c[j].value+"%'";
						}
				}
			}
			// if(c[j].name == "cxms")
			// {
			// 	// alert(c[j].value);
			// }
		}
		
	}
	$.post("/t/countAjax",
        {page:pagenum,
         qstring1:qstring,},
        function(data){
        if(data.length>0)
        {
        	// var data1;
        	// data1 = eval(data);
        	var ind = data.indexOf("pageleng:");
        	var data1 = data.substr(0,ind);
        	var pagenumdata = data.substr(ind+9,data.length);//页数信息
        	var	pageleng = pagenumdata.substr(0,pagenumdata.indexOf("nowpage:"));
        	var pagenow = pagenumdata.substr(pagenumdata.indexOf("nowpage:")+8,pagenumdata.length);
        	data1 = eval(data1);
        	$("#datatable tr:gt(0)").remove();
        	for(var i =0;i<data1.length;i++)
        	{
        		$("#datatable").append("<tr><td><input type=\"checkbox\" class=\"bgcbox\" /></td>");
        		for(var j=0;j<data1[i].length;j++)
        		{
        			$("#datatable tr:last").append("<td>"+data1[i][j]+"</td>");
        		}
        		$("#datatable").append("</tr>");
        	}
        	$("#pagestyle li").remove();
        	if(pageleng>1&&pagenow>1){
        		$("#pagestyle").append("<li> <a  title='上一页' href='javascript:void(0);' onclick='pageclick("+(pagenow-1)+")'><span>&lt;&lt;</span></a></li>");
			}
			for(var q = 1;q<=pageleng;q++)
			{
				if(q==pagenow)
				{
					$("#pagestyle").append("<li>  <a  title='当前页:"+pagenow+"'><span>"+pagenow+"</span></a></li>");
				}
				else
					$("#pagestyle").append("<li>  <a  href='javascript:void(0);' onclick='pageclick("+q+")' title='跳转到第"+q+"页'><span>"+q+"</span></a></li>");
			} 
			if(pagenow<pageleng)
			{
				var pagenex = parseInt(pagenow) + 1;
				$("#pagestyle").append("<li> <a  title='下一页' href='javascript:void(0);' onclick='pageclick("+(pagenex)+")'><span>&gt;&gt;</span></a></li>");
			}

        }

    });
}

// String.prototype.replaceAll  = function(s1,s2){     
//     return this.replace(new RegExp(s1,"gm"),s2);     
// }   
changeTwoDecimal= function changeTwoDecimal(floatvar)
{
	var f_x = parseFloat(floatvar);
	if (isNaN(f_x))
	{
	alert('function:changeTwoDecimal->parameter error');
	return false;
	}
	var f_x = Math.round(floatvar*100)/100;
	return f_x;
}